<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>DMS Sync</title>
<style>
table, th, td {
  border: 1px solid black;
 }
th, td {
  padding: 5px;
}
</style>
	
</head>

<body>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.0.min.js"></script>
	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script>	
        function getMetaData() {
			var u1 = '';
       		var p1 = '';
			 var d1 = $("#evdRef").val();         
     		//var url1 = "https://decide-eu-pw.bentley.com/ws/v2.8/Repositories/Bentley.PW--decide-eu-pw.bentley.com~3Adecide-eu-pw-02/PW_WSG/Document!poly?&$filter=FileName+like+%27" + d1 + "%27";
			var url1 = "https://amey-pw-ws.bentley.com/ws/v2.8/Repositories/Bentley.PW--amey-pw.bentley.com~3Aamey-pw-06/PW_WSG/Document!poly?$filter=FileName+like+%27" + d1 + "%27";

            $.ajax({
                url: url1,
                success: function(data) {	
						console.log(data);		   
			if (data.instances.length== 0) {
			swal("Not found!", "", "warning");
		    } else {
			swal("Success!", "", "success");
		
			for (var i=0; i<data.instances.length; i++){
				var guid = "<tr><td><b>GUID:</b>" + data.instances[i].instanceId + "</td>";
                var name ="<td><b>Name:</b>" + data.instances[i].properties.Name + "</td>";
                var fname = "<td><b>FileName:</b>" + data.instances[i].properties.FileName + "</td>";
                var desc = "<td><b>Description:</b>" + data.instances[i].properties.Description + "</td>";
			    var vers = "<td><b>Version:</b>" + data.instances[i].properties.Version + "</td>";
			    var updatedby = "<td><b>Updated By:</b>" + data.instances[i].properties.FileUpdatedBy + "</td>";
                var createdby ="<td><b>Created By:</b>" + data.instances[i].properties.CreatedBy + "</td></tr>";
				$('#mdata').append(guid + name + fname + desc + vers + updatedby + createdby);
					}
							
		}
                
			     },				    
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert(textStatus, errorThrown);
                    console.log(errorThrown);
                },
			  // headers: {
                //'Authorization': 'Basic bWFkaHVhOndlbGNvbWUxMjM=',Access-Control-Allow-Credentials: true
                //},
       crossDomain: true,
				
                beforeSend: function(xhr) {
                   xhr.setRequestHeader("Authorization", "Basic QmVudGxleS1DUC1QVy1BbWV5OkFtZXlAMjAyNQ==");
                },				
                type: 'GET',
                dataType: 'json',
            });

        }
	
    </script>
	Document Reference: <br>
	<input id = "evdRef" type = "text"><br><br>
	<input type="button" onclick="getMetaData()" value="Get meta-data">
	<br><br><b></b>
	<div id="display">
		<table id = "mdata">
		</table>
    </div>
</body>

</html>
