<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>DMS Sync</title>
<style>
table, th, td {
  border: 1px solid black;
 }
th, td {
  padding: 5px;
}
</style>
	
</head>

<body>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.0.min.js"></script>
	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

    <script>	
        function getMetaData() {
			//var u1 = $("#u").val();
       		//var p1 = $("#p").val();
			 var d1 = $("#evdRef").val();         
			//var url1 = 'https://decide-eu-pw.bentley.com/ws/v2.4/Repositories/Bentley.PW--decide-eu-pw.bentley.com~3Adecide-eu-pw-02/PW_WSG/Document!poly?$top=4';
     		var url1 = "https://decide-eu-pw.bentley.com/ws/v2.8/Repositories/Bentley.PW--decide-eu-pw.bentley.com~3Adecide-eu-pw-02/PW_WSG/Document!poly?&$filter=FileName+like+%27" + d1 + "%27";
            $.ajax({
                url: url1,
                success: function(data) {	
						console.log(data);		   
			if (data.instances.length== 0) {
			swal("Not found!", "", "warning");
		    } else {
			swal("Success!", "", "success");
				$('#display').html("<table>");							   
			for (var i=0; i<data.instances.length; i++){
				var head = '<tr><th>GUID</th><th>Name</th><th>File Name</th><th>Description</th><th>Version</th><th>Updated by</th><th>Created by</th></tr>';
				var guid = "<tr><td>" + data.instances[i].instanceId + "</td>";
                var name ="<td>" + data.instances[i].properties.Name + "</td>";
                var fname = "<td>" + data.instances[i].properties.FileName + "</td>";
                var desc = "<td>" + data.instances[i].properties.Description + "</td>";
			    var vers = "<td>" + data.instances[i].properties.Version + "</td>";
			    var updatedby = "<td>" + data.instances[i].properties.FileUpdatedBy + "</td>";
                var createdby ="<td>" + data.instances[i].properties.CreatedBy + "</td></tr>";
				$('#display').append(head + guid + name + fname + desc + vers + updatedby + createdby );
					}
			$('#display').html("</table>");	
		}
                
			     },				    
                error: function(XMLHttpRequest, textStatus, errorThrown) {
                    alert(textStatus, errorThrown);
                    console.log(errorThrown);
                },
               // headers: {
                //'Authorization': 'Basic bWFkaHVhOndlbGNvbWUxMjM=',
                //},
                beforeSend: function(xhr) {
                   xhr.setRequestHeader("Authorization", "Basic Q29tcGx5UHJvVGVzdFVzZXI6Q29tcGx5cHJvLTE=");
                },				
                type: 'GET',
                dataType: 'json',
            });

        }
	
    </script>
	Document Reference: <br>
	<input id = "evdRef" type = "text"><br><br>
	<input type="button" onclick="getMetaData()" value="Get meta-data">
	<br>
	<div id="display">
    </div>
</body>

</html>
